<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<!DOCTYPE html>
<html>

<head>
	<title>Chat</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
		integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
		integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css"
		href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
	<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.js"></script>
	<link rel="stylesheet" href="/css/custom.css">
	<!-- Remember to include jQuery :) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

<!-- jQuery Modal -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

</head>
<!--Coded With Love By Mutiullah Samim-->

<body>
	<div class="container-fluid h-100">
		<div class="row justify-content-center h-100">
			<div class="col-md-4 col-xl-3 chat">
				<div class="card mb-sm-3 mb-md-0 contacts_card">
					<div class="card-header">
						<div class="input-group">
							<input type="text" placeholder="Search..." name="" class="form-control search">
							<div class="input-group-prepend">
								<span class="input-group-text search_btn"><i class="fas fa-search"></i></span>
							</div>
						</div>
					</div>
					<div class="card-body contacts_body">
						<ui class="contacts" id="ui-list">

						</ui>
					</div>
					<div class="card-footer"></div>
				</div>
			</div>
			<div class="col-md-8 col-xl-6 chat">
				<div class="card">
					<div class="card-header msg_head">
						<div class="d-flex bd-highlight">
							<div class="img_cont" id="whom-am-chatting-img">
								<img src="https://static.turbosquid.com/Preview/001292/481/WV/_D.jpg"
									class="rounded-circle user_img">
								<span class="online_icon"></span>
							</div>
							<div class="user_info" id="whom-am-chatting">
								<span></span>
								<p></p>
							</div>
							<div class="video_cam">
								<span><i class="fas fa-video"></i></span>
								<span><i class="fas fa-phone"></i></span>
								<span><i class="fas fa-sign-out-alt"></i></span>
								<span>
									<a href="#ex1" rel="modal:open">
										<i class="fas fa-users text-white"></i>
									</a>
								</span>

								<!-- <span id="action_room_btn">
									
										<i class="fas fa-door-closed text-white"></i>
									
								</span>
								
								<div class="action_room">
									<ul >
										
									</ul>
								</div> -->
								

							</div>


						</div>
						<span id="action_menu_btn"><i class="fas fa-ellipsis-v"></i></span>
						
					</div>
					<div class="action_menu">
						<ul id="action_menu_id">
							
						</ul>
					</div>
					<div class="card-body msg_card_body" id="msg_card_bd">

					</div>
					<div class="card-footer">
						<form class="current-message-submit">
							<div class="input-group">
								<div class="input-group-append">
									<span class="input-group-text attach_btn"><i class="fas fa-paperclip"></i></span>
								</div>
								<div class="input-group-append" hidden="true">
									<input name="chatid" id="direct-message-chatid"/>
								</div>
								<textarea name="message" class="form-control type_msg"
									placeholder="Type your message..." id="typed-message-id"></textarea>
								<div class="input-group-append">
									<button class="input-group-text btn btn-default send_btn" type="submit"><i class="fas fa-location-arrow"></i></button>
								</div>
							</div>
						</form>
						
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal -->
	<div id="ex1" class="modal">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
			
			  <div class="modal-body">
				<form class="modal-form">
					<div class="form-group">
						<label for="exampleFormControlInput1">Add room</label>
						<input type="text" name="RoomName" class="form-control" id="exampleFormControlInput1" placeholder="">
					  </div>

					  <button class="btn btn-default" id="submit-room" type="submit">submit</button>
				</form>
			  </div>
			  
			</div>
		  </div>
		<a href="#" rel="modal:close">Close</a>
		
	</div>
	
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script defer src="js/custom.js" type="text/javascript"></script>
	<script defer src="js/login.js"></script>
	<script defer src="js/services.js"></script>
	<script defer type="text/javascript">
		$(document).ready(function () {
			const localdata = "saved"
			const savedData = JSON.parse(localStorage.getItem(localdata))
			console.log("saved data", savedData)
			if (savedData !== null) {
				//window.location.replace("login.html");
				//alert(savedData.userId);
				getAllUsers();
				getRooms();
				



			} else {
				window.location.href = "login.html"
			}



			$(".modal-form").submit((e) => {
				e.preventDefault();
				//alert($("#exampleFormControlInput1").val());
				let formData = new FormData(e.target)
				createRoom(formData);

				$.modal.close();
				
			})

			$(".current-message-submit").submit((e) => {
				e.preventDefault();
				let formdata = new FormData(e.target);
				sendChatMessage(formdata)
				
				//alert("message submitted")
			})





		});
	</script>
</body>

</html>

